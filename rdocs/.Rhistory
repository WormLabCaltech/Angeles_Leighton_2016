source("http://bioconductor.org/biocLite.R")
biocLite("rhdf5")
a
source("http://bioconductor.org/biocLite.R")
biocLite("rhdf5")
biocLite("biomaRt")
mart <- biomaRt::useMart(biomart = "ensembl", dataset = "celegans_gene_ensembl")
t2g <- biomaRt::getBM(attributes = c("ensembl_transcript_id", "ensembl_gene_id",
"external_gene_name"), mart = mart)
t2g <- dplyr::rename(t2g, target_id = ensembl_transcript_id,
ens_gene = ensembl_gene_id, ext_gene = external_gene_name)
devtools::install_github("pachterlab/sleuth")
install.packages("devtools")
devtools::install_github("pachterlab/sleuth")
library("sleuth")
mart <- biomaRt::useMart(biomart = "ensembl", dataset = "celegans_gene_ensembl")
t2g <- biomaRt::getBM(attributes = c("ensembl_transcript_id", "ensembl_gene_id",
"external_gene_name"), mart = mart)
t2g <- dplyr::rename(t2g, target_id = ensembl_transcript_id,
ens_gene = ensembl_gene_id, ext_gene = external_gene_name)
base_dir <- "~/WormFiles/agingRNAseq/input/sleuth"
sample_id <- dir(file.path(base_dir, "results"))
kal_dirs <- sapply(sample_id, function(id) file.path(base_dir, "results", id, "kallisto"))
kal_dirs
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors=FALSE)
s2c <- dplyr::select(s2c, sample = run_accession, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
models(so)
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'null_genotype')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'null_age')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'null_genotype', 'full')
sleuth_live(so)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors=FALSE)
s2c <- dplyr::select(s2c, sample = run_accession)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors=True)
s2c <- dplyr::select(s2c, sample = run_accession, age, genotype)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= TRUE)
s2c <- dplyr::select(s2c, sample = run_accession, age, genotype)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
sec
s2c
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c
s2c <- dplyr::select(s2c, sample = run_accession, age, genotype)
print(s2c)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
base_dir <- "~/WormFiles/agingRNAseq/input/sleuth"
#get ids
sample_id <- dir(file.path(base_dir, "results"))
kal_dirs <- sapply(sample_id, function(id) file.path(base_dir, "results", id, "kallisto"))
kal_dirs
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = run_accession, age, genotype)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, age, genotype)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
print(s2c)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
print(s2c)
kal_dirs
kal_dirs[0]
kal_dirs(0)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = sample)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = sample, experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'null_genotype')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'null_age')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'null_genotype', 'full')
sleuth_live(so)
print(s2c)
models(so)
sleuth_live(so)
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_test(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
so
sleuth_to_matrix(so, 'obs_norm', 'tpm')
head(sleuth_to_matrix(so, 'obs_norm', 'tpm'))
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1,1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[0]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[,1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[0,1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[0]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[2]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[:1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')(1)
sleuth_to_matrix(so, 'obs_norm', 'tpm')(2)
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1;2]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1:2]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1:1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[1]
sleuth_to_matrix(so, 'obs_norm', 'tpm')[2]
print.so
print.sleuth_model(so)
print.
print.so()
models
models(so)
sleuth_live(so)
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
#so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'null_genotype')
#so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'null_age')
so <- sleuth_test(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
#so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'null_genotype')
#so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'null_age')
so <- sleuth_wtt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
#Wald test implementations
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
#so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'null_genotype')
#so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'null_age')
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
sleuth_live(so)
results_table <- sleuth_results(so, 'ageyoung')
results_table
results_table[0]
results_table[1]
results_table[:1]
results_table[:,1]
results_table[0,1]
results_table[0,2]
results_table[1,2]
results_table[1,3]
head(results_table)
results_table <- sleuth_results(so, 'interaction', 'ageyoung')
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
results_table <- sleuth_results(so, 'interaction', 'ageyoung')
results_table <- sleuth_results(so, 'wt', interaction', 'ageyoung')
results_table <- sleuth_results(so, 'wt', 'interaction', 'ageyoung')
results_table <- sleuth_results(so, test_type= 'wt', 'interaction', 'ageyoung')
results_table <- sleuth_results(so, test_type= 'wt', which_model= 'interaction')
results_table <- sleuth_results(so, 'interaction', test_type= 'wt', which_model= 'interaction')
results_table <- sleuth_results(so, ,'interaction', test_type= 'wt', which_model= 'interaction')
results_table <- sleuth_results(so, ,'interaction', test_type= 'wt', which_model= 'interaction')
results_table <- sleuth_results(so, 'ageyoung','interaction', test_type= 'wt', which_model= 'interaction')
results_table <- sleuth_results(so, 'ageyoung')
results_table <- sleuth_results(so, 'ageyoung','interaction')
results_table <- sleuth_results(so, 'ageyoung','interaction', test_type= 'wt')
results_table
head(results_table)
write.csv(results_table, "~/WormFiles/agingRNAseq/input/agebeta_wt.csv")
results_table <- sleuth_results(so,'lrt')
results_table <- sleuth_results(so, which_model='lrt')
results_table <- sleuth_results(so, test_type='lrt')
results_table <- sleuth_results(so, 'full', test_type='lrt', which_model = 'interaction')
tests(so)
results_table <- sleuth_results(so, 'full', test_type='lrt')
results_table <- sleuth_results(so, 'lrt', test_type='lrt')
results_table <- sleuth_results(so, 'full:interaction', test_type='lrt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/intercept_wt.csv")
write.csv(results_table, "~/WormFiles/agingRNAseq/input/lrt.csv")
results_table <- sleuth_results(so, 'ageyoung','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/agebeta_wt.csv")
results_table <- sleuth_results(so, 'genotypeN2','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/genotypebeta_wt.csv")
results_table <- sleuth_results(so, 'genotypeN2:ageyoung','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/genotypecrossagebeta_wt.csv")
results_table <- sleuth_results(so, '(Intercept)','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/intercept_wt.csv")
results_table <- sleuth_results(so, 'full:interaction', test_type='lrt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/lrt.csv")
models(so)
s2c
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
#so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
models(so)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
models(so)
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
models(so)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ g
models(so)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
#so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
models(so)
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
models(so)
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
#no interactions
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
#model with interaction
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
#likelihood test
so <- sleuth_lrt(so, 'full', 'interaction')
#if you want to look at shiny
sleuth_live(so)
sleuth_live(so)
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'full')
#model with interaction
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageyoung', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypeN2:ageyoung', which_model = 'interaction')
#likelihood test
so <- sleuth_lrt(so, 'full', 'interaction')
models(so)
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'full')
#model with interaction
so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt:ageold', which_model = 'interaction')
#likelihood test
so <- sleuth_lrt(so, 'full', 'interaction')
sleuth_live(so)
results_table <- sleuth_results(so, 'ageold','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/agebeta_wt.csv")
results_table <- sleuth_results(so, 'genotypemt','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/genotypebeta_wt.csv")
results_table <- sleuth_results(so, 'genotypemt:ageold','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/genotypecrossagebeta_wt.csv")
results_table <- sleuth_results(so, '(Intercept)','interaction', test_type= 'wt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/intercept_wt.csv")
results_table <- sleuth_results(so, 'full:interaction', test_type='lrt')
write.csv(results_table, "~/WormFiles/agingRNAseq/input/lrt.csv")
sleuth_live(so)
sleuth_live(so)
sleuth_live(so)
setwd('~/WormFiles/agingRNAseq/rdocs')
#gene info for sleuth
mart <- biomaRt::useMart(biomart = "ensembl", dataset = "celegans_gene_ensembl")
t2g <- biomaRt::getBM(attributes = c("ensembl_transcript_id", "ensembl_gene_id",
"external_gene_name"), mart = mart)
t2g <- dplyr::rename(t2g, target_id = ensembl_transcript_id,
ens_gene = ensembl_gene_id, ext_gene = external_gene_name)
#install.packages("devtools")
#say no to binary files
#devtools::install_github("pachterlab/sleuth")
library("sleuth")
#point to your directory+
base_dir <- "~/WormFiles/agingRNAseq/rdocs/sleuth"
#get ids
sample_id <- dir(file.path(base_dir, "results"))
kal_dirs <- sapply(sample_id, function(id) file.path(base_dir, "results", id, "kallisto"))
kal_dirs
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
#so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
#no interactions
#so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'full')
#model with interaction
#so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt:ageold', which_model = 'interaction')
#likelihood test
so <- sleuth_lrt(so, 'full', 'interaction')
#if you want to look at shiny
sleuth_live(so)
mart <- biomaRt::useMart(biomart = "ensembl", dataset = "celegans_gene_ensembl")
t2g <- biomaRt::getBM(attributes = c("ensembl_transcript_id", "ensembl_gene_id",
"external_gene_name"), mart = mart)
t2g <- dplyr::rename(t2g, target_id = ensembl_transcript_id,
ens_gene = ensembl_gene_id, ext_gene = external_gene_name)
#install.packages("devtools")
#say no to binary files
#devtools::install_github("pachterlab/sleuth")
library("sleuth")
#point to your directory+
base_dir <- "~/WormFiles/agingRNAseq/rdocs/sleuth"
#get ids
sample_id <- dir(file.path(base_dir, "results"))
kal_dirs <- sapply(sample_id, function(id) file.path(base_dir, "results", id, "kallisto"))
kal_dirs
s2c <- read.table(file.path(base_dir, "aging_rnaseq_info.txt"), header = TRUE, stringsAsFactors= FALSE)
s2c <- dplyr::select(s2c, sample = experiment, genotype, age)
s2c <- dplyr::mutate(s2c, path = kal_dirs)
print(s2c)
#prepend and make object, state maximum model here
so <- sleuth_prep(s2c, ~ genotype+age+genotype*age, target_mapping= t2g)
#fit the models
so <- sleuth_fit(so,~ genotype + age + genotype*age, fit_name = 'interaction')
#so <- sleuth_fit(so,~ genotype, fit_name = 'null_genotype')
#so <- sleuth_fit(so,~ age, fit_name = 'null_age')
so <- sleuth_fit(so,~ genotype + age, fit_name = 'full')
#Wald test implementations
#no interactions
#so <- sleuth_wt(so, which_beta = '(Intercept)', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'full')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'full')
#model with interaction
#so <- sleuth_wt(so, which_beta = '(Intercept)', which_model= 'interaction')
so <- sleuth_wt(so, which_beta = 'ageold', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt', which_model = 'interaction')
so <- sleuth_wt(so, which_beta = 'genotypemt:ageold', which_model = 'interaction')
#likelihood test
so <- sleuth_lrt(so, 'full', 'interaction')
#if you want to look at shiny
sleuth_live(so)
